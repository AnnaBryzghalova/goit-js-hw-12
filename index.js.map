{"version":3,"file":"index.js","sources":["../src/js/izi-toast-wrapper.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["const commonOptions = {\n  position: 'topRight',\n  pauseOnHover: true,\n  closeOnClick: true,\n};\n\nimport iziToast from 'izitoast';\n\nexport function showInfo(message) {\n  iziToast.info({\n    message,\n    progressBarColor: '#0071BD',\n    title: 'Info',\n    ...commonOptions,\n  });\n}\n\nexport function showSuccess(message) {\n  iziToast.success({\n    message,\n    progressBarColor: '#007E33',\n    title: 'Success',\n    ...commonOptions,\n  });\n}\n\nexport function showError(message) {\n  iziToast.error({\n    message,\n    progressBarColor: '#b51b1b',\n    title: 'Error',\n    ...commonOptions,\n  });\n}\n","const API_KEY = '48467053-1861d826b8af29f86703a6302';\n\nimport axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com';\n\nconst defaultParams = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n};\n\nexport async function fetchImagesData(searchQuery, page = 1, per_page = 12) {\n  const response = await axios.get('/api/', {\n    params: {\n      q: searchQuery,\n      page,\n      per_page,\n      ...defaultParams,\n    },\n  });\n\n  return response.data;\n}\n","function renderGalleryItem({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `\n  <li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n      <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n      <div class=\"gallery-item-info\">\n        <div class=\"field\">\n          <span class=\"label\">Likes</span>\n          <span class=\"value\" data-likes>${likes}</span>\n        </div>\n        <div class=\"field\">\n          <span class=\"label\">Views</span>\n          <span class=\"value\" data-views>${views}</span>\n        </div>\n        <div class=\"field\">\n          <span class=\"label\">Comments</span>\n          <span class=\"value\" data-comments>${comments}</span>\n        </div>\n        <div class=\"field\">\n          <span class=\"label\">Downloads</span>\n          <span class=\"value\" data-downloads>${downloads}</span>\n        </div>\n      </div>\n  </a>\n</li>`;\n}\n\nexport function renderGalleryItems(images) {\n  return images.map(renderGalleryItem).join('');\n}\n","const PER_PAGE = 12;\n\nconst gallery = document.querySelector('ul.gallery');\nconst loadingMessage = document.querySelector('.loading-message');\nconst form = document.querySelector('#search-form');\nform.addEventListener('submit', handleFormSubmit);\n\nconst nextPageBtn = document.querySelector('#next-page-btn');\nnextPageBtn.addEventListener('click', () => loadNextPage());\n\nlet lastQuery = '';\nlet currentPage = 1;\nlet totalImages = 0;\n\nimport { showError, showInfo } from './js/izi-toast-wrapper';\nimport { fetchImagesData } from './js/pixabay-api';\nimport { renderGalleryItems } from './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\n\nconst slbConfig = {\n  captionsData: 'alt',\n  captionDelay: 250,\n};\n\nconst simplelightbox = new SimpleLightbox('.gallery a', slbConfig);\n\nfunction handleFormSubmit(event) {\n  event.preventDefault();\n  const query = form.search.value.trim();\n  if (query === '') {\n    showError('Please enter a valid search query!');\n    return;\n  }\n\n  if (query === lastQuery) {\n    return;\n  }\n\n  gallery.innerHTML = '';\n  lastQuery = query;\n  currentPage = 1;\n  loadImages(query, currentPage);\n}\n\nfunction loadNextPage() {\n  currentPage++;\n  loadImages(lastQuery, currentPage);\n}\n\nasync function loadImages(query, page) {\n  loadingMessage.classList.remove('hidden');\n  setNextPageButtonVisible(false);\n\n  try {\n    const imagesData = await fetchImagesData(query, page, PER_PAGE);\n    totalImages = imagesData.total;\n    if (totalImages === 0) {\n      showError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    } else {\n      addImagesOnPage(imagesData.hits);\n    }\n\n    if (isLastPage()) {\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      setNextPageButtonVisible(true);\n    }\n\n    if (page > 1) {\n      scrollByNImages(2);\n    }\n  } catch (error) {\n    showError(error.message);\n  } finally {\n    loadingMessage.classList.add('hidden');\n  }\n}\n\nfunction isLastPage() {\n  return currentPage >= Math.ceil(totalImages / PER_PAGE);\n}\n\nfunction addImagesOnPage(images) {\n  gallery.insertAdjacentHTML('beforeend', renderGalleryItems(images));\n  simplelightbox.refresh();\n}\n\nfunction setNextPageButtonVisible(visible) {\n  console.log(`setNextPageButtonVisible: ${visible}`);\n  if (visible !== nextPageBtn.classList.contains('hidden')) {\n    return;\n  }\n\n  if (visible) {\n    nextPageBtn.classList.remove('hidden');\n  } else {\n    nextPageBtn.classList.add('hidden');\n  }\n}\n\nfunction scrollByNImages(imagesNum) {\n  const firstImage = document.querySelector('.gallery-item');\n  if (firstImage == null) {\n    return;\n  }\n\n  const imageHeight = firstImage.getBoundingClientRect()['height'];\n  console.log(imageHeight);\n\n  window.scrollBy({\n    top: imageHeight * imagesNum,\n    behavior: 'smooth',\n  });\n}\n"],"names":["commonOptions","showInfo","message","iziToast","showError","API_KEY","axios","defaultParams","fetchImagesData","searchQuery","page","per_page","renderGalleryItem","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGalleryItems","images","PER_PAGE","gallery","loadingMessage","form","handleFormSubmit","nextPageBtn","loadNextPage","lastQuery","currentPage","totalImages","slbConfig","simplelightbox","SimpleLightbox","event","query","loadImages","setNextPageButtonVisible","imagesData","addImagesOnPage","isLastPage","scrollByNImages","error","visible","imagesNum","firstImage","imageHeight"],"mappings":"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"}